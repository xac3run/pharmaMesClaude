<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pharmaceutical MES System - React Fixed</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const Icons = {
      Plus: () => <span>‚ûï</span>,
      Settings: () => <span>‚öôÔ∏è</span>,
      Copy: () => <span>üìã</span>,
      Play: () => <span>‚ñ∂Ô∏è</span>
    };

    const PharmaceuticalMES = () => {
      const [activeTab, setActiveTab] = useState("templates");
      const [templates, setTemplates] = useState([
        { id: 1, name: "Aspirin 325mg - Tableting Process", version: "1.2", status: "approved", steps: 3 },
        { id: 2, name: "Paracetamol 500mg - Coating Process", version: "2.1", status: "draft", steps: 5 },
        { id: 3, name: "Ibuprofen 200mg - Encapsulation", version: "1.0", status: "review", steps: 4 }
      ]);

      // üî• NEW: –¥–ª—è –º–æ–¥–∞–ª–∫–∏
      const [editingTemplate, setEditingTemplate] = useState(null);
      const [modalOpen, setModalOpen] = useState(false);

      const createTemplate = () => {
        const newTemplate = {
          id: templates.length + 1,
          name: `New Template ${templates.length + 1}`,
          version: "0.1",
          status: "draft",
          steps: 1
        };
        setTemplates([...templates, newTemplate]);
      };

      const configureTemplate = (template) => {
        setEditingTemplate({ ...template });
        setModalOpen(true);
      };

      const saveTemplate = () => {
        setTemplates(prev =>
          prev.map(t => (t.id === editingTemplate.id ? editingTemplate : t))
        );
        setModalOpen(false);
      };

      const copyTemplate = (template) => {
        const copy = {
          ...template,
          id: templates.length + 1,
          name: `${template.name} (Copy)`,
          status: "draft"
        };
        setTemplates([...templates, copy]);
      };

      const startBatchFromTemplate = (template) => {
        alert(`‚ñ∂Ô∏è Starting batch from "${template.name}"`);
      };

      return (
        <div className="p-6">
          {/* Tabs */}
          <div className="mb-6">
            <button onClick={() => setActiveTab("dashboard")} className="mr-4">üìä Dashboard</button>
            <button onClick={() => setActiveTab("batches")} className="mr-4">üß™ Batches</button>
            <button onClick={() => setActiveTab("templates")}>üìã eBR Templates</button>
          </div>

          {activeTab === "templates" && (
            <div className="bg-white rounded-lg shadow-sm border p-6">
              <div className="flex items-center justify-between mb-6">
                <h3 className="text-lg font-semibold">eBR Templates Management</h3>
                <button
                  onClick={createTemplate}
                  className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
                >
                  <Icons.Plus /> Create New Template
                </button>
              </div>

              <div className="space-y-4">
                {templates.map((template) => (
                  <div key={template.id} className="border rounded-lg p-4 flex justify-between items-center">
                    <div>
                      <h4 className="font-medium">{template.name}</h4>
                      <div className="text-sm text-gray-600">
                        Version {template.version} ‚Ä¢ {template.steps} steps
                      </div>
                    </div>
                    <div className="flex gap-2">
                      <button
                        onClick={() => configureTemplate(template)}
                        className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                      >
                        <Icons.Settings /> Configure
                      </button>
                      <button
                        onClick={() => copyTemplate(template)}
                        className="px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700"
                      >
                        <Icons.Copy /> Copy
                      </button>
                      {template.status === "approved" && (
                        <button
                          onClick={() => startBatchFromTemplate(template)}
                          className="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700"
                        >
                          <Icons.Play /> Start Batch
                        </button>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* üî• Modal for Configure */}
          {modalOpen && editingTemplate && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
              <div className="bg-white p-6 rounded shadow-lg w-96">
                <h3 className="text-lg font-semibold mb-4">‚öôÔ∏è Configure Template</h3>
                <label className="block mb-2 text-sm font-medium">Name</label>
                <input
                  type="text"
                  value={editingTemplate.name}
                  onChange={(e) =>
                    setEditingTemplate({ ...editingTemplate, name: e.target.value })
                  }
                  className="w-full border rounded p-2 mb-4"
                />
                <label className="block mb-2 text-sm font-medium">Version</label>
                <input
                  type="text"
                  value={editingTemplate.version}
                  onChange={(e) =>
                    setEditingTemplate({ ...editingTemplate, version: e.target.value })
                  }
                  className="w-full border rounded p-2 mb-4"
                />
                <div className="flex justify-end gap-2">
                  <button onClick={() => setModalOpen(false)} className="px-4 py-2 bg-gray-300 rounded">
                    Cancel
                  </button>
                  <button onClick={saveTemplate} className="px-4 py-2 bg-blue-600 text-white rounded">
                    Save
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<PharmaceuticalMES />);
  </script>
</body>
</html>
